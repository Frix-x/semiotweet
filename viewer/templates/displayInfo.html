{% extends "template.html" %} {% block title %} | @{{screen_name}} {% endblock %} {% block content %} {% if success %}
<div class="section no-pad-bot" id="index-banner">
    <div class="container">
        <br><br>
        <!--<h1 class="header center darken-1-text">User information</h1>-->
        <br><br>
    </div>
</div>
<div class="container">
    <div class="section">
        <div class="row">
            <div class="col s12 m8">
                <div class="icon-block">
                    <div class="card horizontal">
                        <div class="card-image">
                            {% if userInfo.profile_image_url_https %}
                            <img src="{{userInfo.profile_image_url_https}}"> {% endif %}
                        </div>
                        <div class="card-stacked">
                            <div class="card-content">
                                <h5>{{userInfo.name}}</h5>
                                <p>@{{screen_name}}
                                {% if userInfo.verified %}
                                <img src="/static/images/verified.png" height="25" width="25" alt="Verified"> {% endif %}
                                <br></p>
                                <p>{{userInfo.description}}</p>
                            </div>
                            <div class="card-action">
                                <p>{{userInfo.followers_count}} followers</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col s12 m4" id="TweetSources">
                <div class="icon-block">
                    <h5 class="center">Tweet sources</h5>
                    <canvas id="doughnutSources"></canvas>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="icon-block" id="Words">
                <canvas id="MostCommonWords"></canvas>
            </div>
        </div>
        <div class="row">
            <div class="icon-block" id="Distribution">
                <canvas id="HoursDistribution"></canvas>
            </div>
        </div>
    </div>
</div>
{% else %}
<div class="section no-pad-bot" id="index-banner">
    <div class="container">
        <br><br>
        <h1 class="header center orange-text">Error</h1>
        <div class="row center">
            <h5 class="header col s12 light">Internal server error...</h5>
        </div>
        <br><br>
    </div>
</div>
{% endif %}
{% endblock %}

{%block script%}


<script>
var words = {{words|safe}};
if (words.length == 0)
  $( "#Words").html("<div class='row center'><h3>No data yet. Click <a href='/getData/'>here</a> to update data</h3></div>");
else{
      words.sort(function(a, b) {
          return b.occur - a.occur
      });
      var word = [];
      var occur = [];
      var colorsForBars = ['rgba(54, 162, 235, 1)'] * words.length;

      for (i = 0; i < words.length; i++) {
          word.push(words[i].word);
          occur.push(words[i].occur);
      }

      var ctx = document.getElementById("MostCommonWords");

      var data = {
          labels: word,
          datasets: [{
              label: "Most common words",
              data: occur,
              backgroundColor: colorsForBars,
              borderColor: colorsForBars
          }]
      };
      var options = {
          animation: {
              animateScale: true
          },
          title: {
              display: false,
              text: 'Most Common Words used by {{userInfo.name}}'
          }
      };
      var myBarChart = new Chart(ctx, {
          type: 'bar',
          data: data,
          options: options
      });
}

var sources = {{sources|safe}};
var num = {{num|safe}};
if (sources.length == 0 && num.length == 0)
  $( "#TweetSources").html("<div class='row center'><h3>No data yet. Click <a href='/getData/'>here</a> to update data</h3></div>");
else{
  var ctx = document.getElementById("doughnutSources");
  var colors = ["#FF6384","#36A2EB","#FFCE56","#FFBA49","#20A39E",
                "#EF5B5B","#23001E","#A4A9AD","#8CDFD6","#5A716A"];
  var data = {
    labels: sources,
    datasets: [
        {
            data: num,
            backgroundColor: colors,
            hoverBackgroundColor: colors
        }]
  };
  var options = {
      animation:{
          animateScale:true
      },
      title: {
          display: false,
          text: 'Tweet Sources'
      }
  };
  var myDoughnutChart = new Chart(ctx, {
      type: 'doughnut',
      data: data,
      options: options
  });
}

var hours = {{hours|safe}};
if (hours.length != 0){
      var colorsForBars = ['#060709', '#0e1420', '#13182c', '#162640', '#22345c', '#2c4e8d', '#4673b6', '#68a1d8', '#98cfee', '#b7e2f5', '#a9d5f2', '#9fcaed',
                            '93bde3', '#87aed9', '#789ccc', '#7399c6', '#7080bb' , '#5d6ab0', '#364392', '#272e64', '#272e64', '#0f1221', '#0f1221', '#0f1221' ];

      var ctx = document.getElementById("HoursDistribution");

      var data = {
          labels: [0, 1, 2, 3, 4, 5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],
          datasets: [{
              label: "Number of tweets",
              data: hours,
              backgroundColor: colorsForBars,
              borderColor: colorsForBars
          }]
      };
      var options = {
          animation: {
              animateScale: true
          },
          title: {
              display: true,
              text: 'Post count per hour'
          },

      };
      var myBarChart = new Chart(ctx, {
          type: 'bar',
          data: data,
          options: options
      });
}

</script>
{% endblock %}
