{% extends "template.html" %}
{% block title %} | Accueil {% endblock %}
{% load static %}
{% block content %}

<div class="section no-pad-bot" id="index-banner">
  <div class="container">
      <br><br>
      <h1 class="header center orange-text">Comparer 2 candidats</h1>
      <br><br>
  </div>
</div>


<div class="container">
    <div class="section">
      <form method="get" action="">
          <div class="row">
            <div class="input-field col s12 m6">
              <select name="candidat1" id="candidat1">
                  <option value="" disabled selected>Selectionner un candidat...</option>
                {% for screen_name, value in users.items %}
                  <option value="{{screen_name}}" data-icon="{{value.profile_image_url_https}}" class="left circle">{{value.name}}</option>
                {% endfor %}
              </select>
              <label>Candidat 1</label>
            </div>
            <div class="input-field col s12 m6">
              <select name="candidat2" id="candidat2">
                <option value="" disabled selected>... puis un deuxième, évidemment !</option>
                {% for screen_name, value in users.items %}
                  <option value="{{screen_name}}" data-icon="{{value.profile_image_url_https}}" class="left circle">{{value.name}}</option>
                {% endfor %}
              </select>
              <label>Candidat 2</label>
            <label>
            </label>
            </div>
        </div>
        <div class="row">
          <div class="col s12 m12 center">
            <button class="btn waves-effect waves-light" type="submit" name="action">Comparer
              <i class="material-icons right">send</i>
            </button>
            </div>
        </div>
      </form>
    </div>
    <br><br>
    {% if candidats %}
      <div class="section">
          <div class="row">
            {% for candidat in candidats %}
              <div class="col s6 m6">
                  <div class="icon-block">
                      <h5 class="center">Mots les plus employés</h5>
                      <canvas id="MostCommonWords{{candidat}}"></canvas>
                  </div>
                  <div class="icon-block">
                      <h5 class="center">Lemmes les plus employés</h5>
                      <canvas id="MostCommonLemmes{{candidat}}"></canvas>
                  </div>
                  <div class="icon-block">
                      <h5 class="center">Distribution des tweets selon les heures</h5>
                      <canvas id="HoursDistribution{{candidat}}"></canvas>
                  </div>
                  <div class="icon-block">
                      <h5 class="center">Sources des tweets</h5>
                      <div class="col s10 m10">
                        <canvas id="doughnutSources{{candidat}}"></canvas>
                      </div>
                  </div>
              </div>
            {% endfor %}
          </div>
      </div>
    {% endif %}
</div>
{% endblock %}

{% block script %}
<script src="{% static "js/Chart.js" %}"></script>
<script src="{% static "js/utils.js" %}"></script>
<script>
  $(document).ready(function() {
      $('select').material_select();

      {% if candidats %}
          createBarChart("MostCommonWords{{candidats.0}}",{{wordsList.0|safe}}, "Mots les plus communs");
          createDonut("doughnutSources{{candidats.0}}", {{sourcesList.0|safe}}, {{numList.0|safe}});
          createBarChart("MostCommonLemmes{{candidats.0}}",{{lemmesList.0|safe}},"Lemmes occurences");
          createBarChartHours("HoursDistribution{{candidats.0}}",{{hoursList.0|safe}},"Nombre de tweets postés");

          createBarChart("MostCommonWords{{candidats.1}}",{{wordsList.1|safe}}, "Mots les plus communs");
          createDonut("doughnutSources{{candidats.1}}", {{sourcesList.1|safe}}, {{numList.1|safe}});
          createBarChart("MostCommonLemmes{{candidats.1}}",{{lemmesList.1|safe}},"Lemmes occurences");
          createBarChartHours("HoursDistribution{{candidats.1}}",{{hoursList.1|safe}},"Nombre de tweets postés");

          document.getElementById('candidat1').value="{{candidats.0}}";
          document.getElementById('candidat2').value="{{candidats.1}}";
          $('select').material_select();
      {% endif %}
  });
</script>
{% endblock %}
