{% extends "template.html" %}
{% block title %} | Keywords network {% endblock %}
{% load static %}

{% block content %}
<div class="section no-pad-bot" id="index-banner">
    <div class="container">
        <br><br>
        <h1 class="header center orange-text">Network</h1>
        <br><br>
    </div>
</div>

<div class="container">
    <div class="section">
        <div class="row">
          <div class="col s12 m12">
            <div class="icon-block">
              <div class="loader" id="keywordsNetwork"></div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block script %}
<script src="{% static "js/utils.js" %}"></script>
<script type="text/javascript">
    $(document).ready(function() {
        $.get('/api/v1/nlp/network/tweets', function(res, status) {
            if (status === 'success') {
                var nodes = new vis.DataSet(res.network.nodes);
                var edges = new vis.DataSet(res.network.edges);
                var container = document.getElementById('keywordsNetwork');

                var data = {
                    nodes: nodes,
                    edges: edges
                };
                var spatialization = {
                    enabled: true,
                    forceAtlas2Based: {
                        gravitationalConstant: -50,
                        centralGravity: 0.01,
                        springConstant: 0.08,
                        springLength: 100,
                        damping: 0.4,
                        avoidOverlap: 0
                    },
                    maxVelocity: 50,
                    minVelocity: 0.1,
                    solver: 'forceAtlas2Based',
                    stabilization: {
                        enabled: true,
                        iterations: 1000,
                        updateInterval: 100,
                        onlyDynamicEdges: false,
                        fit: true
                    },
                    timestep: 0.5,
                    adaptiveTimestep: true
                };
                var options = {
                    autoResize: true,
                    height: '100%',
                    width: '100%',
                    physics: spatialization,
                    clustering: {
                        enabled: true
                    },
                    stabilize: false
                };

                var network = new vis.Network(container, data, options);
                $('#keywordsNetwork').removeClass('loader');
                var graphWidth = $('#keywordsNetwork').width();
                console.log(graphWidth);
                $('#keywordsNetwork').height(graphWidth);
                network.redraw();
            }
        });
    });
</script>
{% endblock %}
